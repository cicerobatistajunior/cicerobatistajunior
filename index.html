<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu Suspenso com Conteúdo Dinâmico</title>
    <style>
        /* Estilos CSS aqui */
    </style>
</head>
<body>
    <div class="container">
        <h1>SISTEMA DE PRESCRIÇÕES DA ROTINA</h1>
        <select id="medicamentoSelect">
            <option value="">Selecione...</option>
            <!-- As opções serão preenchidas dinamicamente com os dados da planilha -->
        </select>
        <div id="conteudo" class="content-box">
            Selecione uma opção para ver a prescrição.
        </div>
        <button id="copyButton" class="copy-button" style="display: none;">Copiar para a área de transferência</button>
        <div id="alertBox" class="alert">Texto copiado para a área de transferência!</div>
        
        <!-- Créditos do autor -->
        <div class="credits">Autor: Cícero Batista. Direitos reservados.</div>
    </div>

    <script>
        // URL da planilha publicada
        const spreadsheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSGL1Mcky-rNQvKn9iXgD_IUdSqqtfZEa1HLhT3JcDAybj1Vw12sPhWKynoy0XmjSERSTTvFoWVlD7z/pubhtml';

        // Função para buscar os dados da planilha e preencher o menu suspenso
        async function preencherMenuSuspenso() {
            try {
                const response = await fetch(spreadsheetURL);
                const data = await response.text();
                const parser = new DOMParser();
                const htmlDocument = parser.parseFromString(data, 'text/html');
                const options = htmlDocument.querySelectorAll('td');
                
                const selectElement = document.getElementById('medicamentoSelect');
                options.forEach((option, index) => {
                    if (index % 2 === 0) { // Pula os valores repetidos
                        const value = option.textContent.trim();
                        const text = options[index + 1].textContent.trim();
                        const optionElement = document.createElement('option');
                        optionElement.value = value;
                        optionElement.textContent = text;
                        selectElement.appendChild(optionElement);
                    }
                });
            } catch (error) {
                console.error('Erro ao buscar os dados da planilha:', error);
            }
        }

        // Função para atualizar o conteúdo com base na seleção
        function atualizarConteudo() {
            const selectedValue = document.getElementById('medicamentoSelect').value;
            const conteudoElement = document.getElementById('conteudo');
            if (selectedValue) {
                conteudoElement.textContent = database[selectedValue];
                document.getElementById('copyButton').style.display = 'block';
            } else {
                conteudoElement.textContent = 'Selecione uma opção para ver a prescrição.';
                document.getElementById('copyButton').style.display = 'none';
            }
        }

        // Função para copiar o texto para a área de transferência
        function copiarTexto() {
            const texto = document.getElementById('conteudo').textContent;
            const inputTemp = document.createElement('textarea');
            inputTemp.value = texto;
            document.body.appendChild(inputTemp);
            inputTemp.select();
            document.execCommand('copy');
            document.body.removeChild(inputTemp);

            // Exibir a mensagem de alerta
            document.getElementById('alertBox').style.display = 'block';
            setTimeout(() => {
                document.getElementById('alertBox').style.display = 'none';
            }, 3000); // A mensagem desaparecerá após 3 segundos
        }

        // Adiciona os eventos necessários
        document.getElementById('medicamentoSelect').addEventListener('change', atualizarConteudo);
        document.getElementById('copyButton').addEventListener('click', copiarTexto);

        // Preencher o menu suspenso ao carregar a página
        preencherMenuSuspenso();
    </script>
</body>
</html>
