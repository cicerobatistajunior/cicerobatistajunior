<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planilha Interativa</title>
</head>
<body>
    <h1>Planilha Interativa</h1>

    <label for="items">Escolha um item:</label>
    <select id="items" onchange="showNextItem()">
        <option value="">Selecione...</option>
    </select>

    <p id="nextItem"></p>

    <script>
        const sheetID = '2PACX-1vSGL1Mcky-rNQvKn9iXgD_IUdSqqtfZEa1HLhT3JcDAybj1Vw12sPhWKynoy0XmjSERSTTvFoWVlD7z';
        const sheetURL = `https://spreadsheets.google.com/feeds/list/${sheetID}/1/public/values?alt=json`;

        let rowData = {};

        function loadSheet() {
            fetch(sheetURL)
                .then(response => response.json())
                .then(data => {
                    const entries = data.feed.entry;
                    const select = document.getElementById('items');

                    // Processa os dados da planilha
                    entries.forEach(entry => {
                        const colA = entry.gsx$chave.$t; // Substitua "nome" pelo título real da coluna A
                        const colB = entry.gsx$valor.$t; // Substitua "descrição" pelo título real da coluna B

                        rowData[colA] = colB; // Mapeia coluna A para coluna B

                        const option = document.createElement('option');
                        option.text = colA;
                        option.value = colA;
                        select.add(option);
                    });
                })
                .catch(error => {
                    console.error('Erro ao carregar a planilha:', error);
                });
        }

        function showNextItem() {
            const selectedItem = document.getElementById('items').value;
            const nextItem = rowData[selectedItem] || 'Item não encontrado';
            document.getElementById('nextItem').innerText = 'Próximo item: ' + nextItem;
        }

        window.onload = function() {
            loadSheet();
        };
    </script>
</body>
</html>
